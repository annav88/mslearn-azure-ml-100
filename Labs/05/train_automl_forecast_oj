from azureml.automl.core.forecasting_parameters import ForecastingParameters

forecasting_parameters = ForecastingParameters(
    time_column_name=time_column_name,
    forecast_horizon=n_test_periods,
    time_series_id_column_names=time_series_id_column_names,
    freq="W-THU",  # Set the forecast frequency to be weekly (start on each Thursday)
    cv_step_size="auto",
)

automl_config = AutoMLConfig(
    task="forecasting",
    debug_log="automl_oj_sales_errors.log",
    primary_metric="normalized_mean_absolute_error",
    experiment_timeout_hours=0.25,
    training_data=train_dataset,
    label_column_name=target_column_name,
    compute_target=compute_target,
    enable_early_stopping=True,
    featurization=featurization_config,
    n_cross_validations="auto",  # Feel free to set to a small integer (>=2) if runtime is an issue.
    verbosity=logging.INFO,
    max_cores_per_iteration=-1,
    forecasting_parameters=forecasting_parameters,
)